@model SurveyWeb.Controllers.QuestionListViewModel

@{
    ViewData["Title"] = "Câu hỏi của khảo sát";
}

<div style="max-width: 1280px; margin: 0 auto; padding: 1.5rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <div>
            <div style="font-size: 0.75rem; color: #6B7280;">Khảo sát</div>
            <h1 style="font-size: 1.25rem; font-weight: bold; color: #111827;">@Model.SurveyTitle</h1>
        </div>

        <a style="background-color: #4F46E5; color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 500; text-decoration: none; display: inline-block;"
           href="@Url.Action("Create","Question", new { surveyId = Model.SurveyId })">
            + Thêm câu hỏi
        </a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div style="background-color: #D1FAE5; border: 1px solid #86EFAC; color: #047857; padding: 0.75rem 1rem; border-radius: 0.5rem; font-size: 0.875rem; margin-bottom: 1rem;">
            @TempData["SuccessMessage"]
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div style="background-color: #FEE2E2; border: 1px solid #FCA5A5; color: #DC2626; padding: 0.75rem 1rem; border-radius: 0.5rem; font-size: 0.875rem; margin-bottom: 1rem;">
            @TempData["ErrorMessage"]
        </div>
    }

    <div style="background-color: white; border: 1px solid #E5E7EB; border-radius: 0.5rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); overflow: hidden;">
        <table style="width: 100%; font-size: 0.875rem;">
            <thead style="background-color: #F9FAFB; border-bottom: 1px solid #E5E7EB; text-align: left; color: #6B7280; text-transform: uppercase; font-size: 0.75rem; font-weight: 600;">
                <tr>
                    <th style="padding: 0.75rem 1rem;">#</th>
                    <th style="padding: 0.75rem 1rem;">Nội dung câu hỏi</th>
                    <th style="padding: 0.75rem 1rem; text-align: center;">Bắt buộc?</th>
                    <th style="padding: 0.75rem 1rem; text-align: center;">Hành động</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Questions != null && Model.Questions.Any())
                {
                    foreach (var q in Model.Questions)
                    {
                        <tr style="border-bottom: 1px solid #E5E7EB;">
                            <td style="padding: 0.75rem 1rem; color: #374151; font-weight: 500;">@q.orderNo</td>
                            <td style="padding: 0.75rem 1rem; color: #111827;">
                                <div style="font-weight: 500;">@q.text</div>
                                <div style="font-size: 0.6875rem; color: #6B7280; margin-top: 0.25rem; word-break: break-all;">
                                    ID: @q._id
                                </div>
                            </td>
                            <td style="padding: 0.75rem 1rem; text-align: center;">
                                @if (q.isRequired)
                                {
                                    <span style="display: inline-flex; align-items: center; padding: 0.125rem 0.625rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; background-color: #D1FAE5; color: #047857;">
                                        Có
                                    </span>
                                }
                                else
                                {
                                    <span style="display: inline-flex; align-items: center; padding: 0.125rem 0.625rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; background-color: #F3F4F6; color: #4B5563;">
                                        Không
                                    </span>
                                }
                            </td>
                            <td style="padding: 0.75rem 1rem;">
                                <div style="display: flex; justify-content: center; align-items: center; gap: 0.75rem;">
                                    <a href="@Url.Action("Edit", "Question", new { surveyId = Model.SurveyId, id = q._id })"
                                       style="display: inline-flex; align-items: center; padding: 0.375rem 0.75rem; border: 1px solid #A5B4FC; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 500; color: #4338CA; background-color: #EEF2FF; text-decoration: none;">
                                        ✏️ Sửa
                                    </a>
                                    <a href="@Url.Action("Delete", "Question", new { surveyId = Model.SurveyId, id = q._id })"
                                       onclick="return confirm('Bạn có chắc muốn xóa câu hỏi này không?\n\nCâu hỏi: @q.text.Replace("'", "\\'").Replace("\"", "&quot;")')"
                                       style="display: inline-flex; align-items: center; padding: 0.375rem 0.75rem; border: 1px solid #FCA5A5; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 500; color: #B91C1C; background-color: #FEF2F2; text-decoration: none;">
                                        🗑️ Xóa
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="4" style="padding: 2rem 1rem; text-align: center;">
                            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; color: #6B7280;">
                                <div style="font-size: 3rem; margin-bottom: 0.75rem;">❓</div>
                                <p style="font-size: 0.875rem; font-weight: 500; margin: 0;">Chưa có câu hỏi nào</p>
                                <p style="font-size: 0.75rem; margin: 0.25rem 0 0 0;">Nhấn nút "Thêm câu hỏi" để bắt đầu tạo câu hỏi cho khảo sát này</p>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div style="margin-top: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
        <a style="display: inline-flex; align-items: center; color: #4F46E5; font-size: 0.875rem; font-weight: 500; text-decoration: none;"
           href="@Url.Action("Index","Survey")">
            ← Quay lại danh sách khảo sát
        </a>
        
        @if (Model.Questions != null && Model.Questions.Any())
        {
            <div style="font-size: 0.875rem; color: #6B7280;">
                Tổng số: <span style="font-weight: 600; color: #374151;">@Model.Questions.Count</span> câu hỏi
            </div>
        }
    </div>
</div>
